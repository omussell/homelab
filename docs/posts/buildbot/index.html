<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">

        <title>Continuous Integration with Buildbot</title>

        <link rel="stylesheet" href="homelab/css/stylesheet.css">
    </head>
    <body>
        <section id="page-title">
            <h1><a href="/">Homelab</a></h1>
        </section>



<section class="blog-post">
    <h1>Continuous Integration with Buildbot</h1>
    <div class="blog-post-subheader">
        January 25, 2018
    </div>
    <div class="blog-post-content">
        

<h2 id="install-the-buildbot-master">Install the buildbot master</h2>

<pre><code>pkg install -y py36-buildbot py36-buildbot-www
</code></pre>

<p>You need to create the config files directory</p>

<pre><code>buildbot create-master master
cd ./master
cp master.cfg.sample master.cfg
buildbot start master
(look at twistd.log if there are errors during startup)
</code></pre>

<p>Enable the services and start</p>

<pre><code>sysrc buildbot_enable=&quot;YES&quot;
sysrc buildbot_basedir=&quot;/var/www/buildbot&quot;
service buildbot start
</code></pre>

<p>Access via a browser at http://$IP:8010/</p>

<p>If using the localworker for testing: <code>pkg install -y py36-buildbot-worker</code></p>

<p>With postgres backend:</p>

<pre><code>master.cfg
c['db'] = {
	'db_url' : &quot;postgresql://buildbot:password@192.168.1.10/buildbotdb&quot;,
}

pip install psycopg2
</code></pre>

<h2 id="install-a-buildbot-worker">Install a buildbot worker</h2>

<p>Install the package and enable</p>

<pre><code>pkg install -y py27-buildbot-worker
sysrc buildbot_worker_enable=YES
sysrc buildbot_basedir=&quot;/usr/local/etc/buildbot_worker&quot;
</code></pre>

<p>Before you start the worker, you need to create its config</p>

<pre><code>buildbot-worker create-worker &lt;basedir&gt; 		     &lt;master_name&gt; &lt;worker_name&gt; &lt;worker_password&gt;
buildbot-worker create-worker /usr/local/etc/buildbot_worker 192.168.1.19  foo 		 pass
</code></pre>

<p>Start the service</p>

<pre><code>service buildbot_worker start
</code></pre>

<p>The config file on the master will then need updating with the worker name and password, and optionally add it to be used for specific builds.</p>

    </div>
</section>

    </body>
</html>