<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">

        <title>Application Packaging with fpm</title>

        <link rel="stylesheet" href="/css/stylesheet.css">
    </head>
    <body>
        <section id="page-title">
            <h1><a href="/">Homelab</a></h1>
        </section>



<section class="blog-post">
    <h1>Application Packaging with fpm</h1>
    <div class="blog-post-subheader">
        January 30, 2018
    </div>
    <div class="blog-post-content">
        

<p>Create a new tagged release on the git repository</p>

<pre><code>git tag 1.4.0
</code></pre>

<p>Create a tarball of the git repository at the particular tag revision. Extracts a folder called app-1.4.0 which contains the contents of the repository at tag 1.4.0.</p>

<pre><code>git archive --format=tar.gz --prefix=app-1.4.0/ -o ~/app-1.4.0.tar.gz 1.4.0
</code></pre>

<h2 id="fpm">fpm</h2>

<p>The <code>fpm</code> ruby gem can be used to convert common package formats into other common package formats, like virtualenv&rsquo;s into freebsd packages. It has support for many different types of packages.</p>

<p>Create a freebsd package of the homelab directory. Its important to use full paths, so that it extracts to the full path rather than relatively.</p>

<pre><code>fpm -s dir -t freebsd -n homelab-1.4.0 /home/oliver/homelab
</code></pre>

<p>To distribute packages, we can use fpm to create tarballs of virtualenvs, node packages and any other required files, then create a freebsd package from all of these tarballs. This gives us a way of tying together all of the dependencies into one package which is easier to deploy. To deploy, we can create our own freebsd package repository and make our own packages available. Servers can then point to this repository, and be instructed to install a particular version of this package.</p>

    </div>
</section>

    </body>
</html>